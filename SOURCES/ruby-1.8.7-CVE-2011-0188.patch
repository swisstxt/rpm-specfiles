--- trunk/ext/bigdecimal/bigdecimal.c	2011/03/01 04:28:58	30992
+++ trunk/ext/bigdecimal/bigdecimal.c	2011/03/01 04:40:49	30993
@@ -2032,11 +2032,11 @@
 VP_EXPORT void *
 VpMemAlloc(U_LONG mb)
 {
-    void *p = xmalloc((unsigned int)mb);
-    if(!p) {
-        VpException(VP_EXCEPTION_MEMORY,"failed to allocate memory",1);
+    void *p = xmalloc(mb);
+    if (!p) {
+        VpException(VP_EXCEPTION_MEMORY, "failed to allocate memory", 1);
     }
-    memset(p,0,mb);
+    memset(p, 0, mb);
 #ifdef _DEBUG
     gnAlloc++; /* Count allocation call */
 #endif /* _DEBUG */
--- trunk/ChangeLog	2011/03/01 04:28:58	30992
+++ trunk/ChangeLog	2011/03/01 04:40:49	30993
@@ -170,6 +170,11 @@
 	* ext/openssl/lib/openssl/bn.rb (Integer#to_bn): OpenSSL::BN.new
 	  accepts only Strings, so call Integer#to_s(16).
 	  16 is for an optimization. [ruby-dev:42336]
+
+Tue Mar  1 13:25:00 2011  Kenta Murata <mrkn@mrkn.jp>
+
+	* ext/bigdecimal/bigdecimal.c (VpMemAlloc): CVE-2011-0188.
+	  Fixes a bug reported by Drew Yao <ayao at apple.com>
 
 Fri Feb 18 21:18:55 2011  Shugo Maeda  <shugo@ruby-lang.org>
 
